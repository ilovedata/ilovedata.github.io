<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>부록 A: 과제 2 해답 | 회귀모형 R 실습</title>
  <meta name="description" content="대학원 선형모형 교재입니다." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="부록 A: 과제 2 해답 | 회귀모형 R 실습" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="대학원 선형모형 교재입니다." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="부록 A: 과제 2 해답 | 회귀모형 R 실습" />
  
  <meta name="twitter:description" content="대학원 선형모형 교재입니다." />
  

<meta name="author" content="서울시립대학교 통계학과 이용희" />


<meta name="date" content="2021-04-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chapter05.html"/>

<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction on Regression Model-R program</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="chap02.html"><a href="chap02.html"><i class="fa fa-check"></i><b>1</b> 단순회귀 예제</a>
<ul>
<li class="chapter" data-level="1.1" data-path="chap02.html"><a href="chap02.html#mammal-자료"><i class="fa fa-check"></i><b>1.1</b> MAMMAL 자료</a></li>
<li class="chapter" data-level="1.2" data-path="chap02.html"><a href="chap02.html#변수의-변환"><i class="fa fa-check"></i><b>1.2</b> 변수의 변환</a></li>
<li class="chapter" data-level="1.3" data-path="chap02.html"><a href="chap02.html#특별한-자료를-찾기"><i class="fa fa-check"></i><b>1.3</b> 특별한 자료를 찾기</a></li>
<li class="chapter" data-level="1.4" data-path="chap02.html"><a href="chap02.html#자료의-정렬"><i class="fa fa-check"></i><b>1.4</b> 자료의 정렬</a></li>
<li class="chapter" data-level="1.5" data-path="chap02.html"><a href="chap02.html#단순회귀모형의-적합"><i class="fa fa-check"></i><b>1.5</b> 단순회귀모형의 적합</a></li>
<li class="chapter" data-level="1.6" data-path="chap02.html"><a href="chap02.html#산점도에서-특정-자료의-표시"><i class="fa fa-check"></i><b>1.6</b> 산점도에서 특정 자료의 표시</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chapter03.html"><a href="chapter03.html"><i class="fa fa-check"></i><b>2</b> 중회귀분석</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chapter03.html"><a href="chapter03.html#중고차-자료"><i class="fa fa-check"></i><b>2.1</b> 중고차 자료</a></li>
<li class="chapter" data-level="2.2" data-path="chapter03.html"><a href="chapter03.html#산점도-행렬"><i class="fa fa-check"></i><b>2.2</b> 산점도 행렬</a></li>
<li class="chapter" data-level="2.3" data-path="chapter03.html"><a href="chapter03.html#중회귀-모형의-적합"><i class="fa fa-check"></i><b>2.3</b> 중회귀 모형의 적합</a></li>
<li class="chapter" data-level="2.4" data-path="chapter03.html"><a href="chapter03.html#회귀계수의-추정과-결정계수"><i class="fa fa-check"></i><b>2.4</b> 회귀계수의 추정과 결정계수</a></li>
<li class="chapter" data-level="2.5" data-path="chapter03.html"><a href="chapter03.html#예측값"><i class="fa fa-check"></i><b>2.5</b> 예측값</a></li>
<li class="chapter" data-level="2.6" data-path="chapter03.html"><a href="chapter03.html#잔차-분석"><i class="fa fa-check"></i><b>2.6</b> 잔차 분석</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapter04.html"><a href="chapter04.html"><i class="fa fa-check"></i><b>3</b> 모형의 진단과 수정</a>
<ul>
<li class="chapter" data-level="3.1" data-path="chapter04.html"><a href="chapter04.html#순차제곱합"><i class="fa fa-check"></i><b>3.1</b> 순차제곱합</a></li>
<li class="chapter" data-level="3.2" data-path="chapter04.html"><a href="chapter04.html#편제곱합"><i class="fa fa-check"></i><b>3.2</b> 편제곱합</a></li>
<li class="chapter" data-level="3.3" data-path="chapter04.html"><a href="chapter04.html#부분-f-검정"><i class="fa fa-check"></i><b>3.3</b> 부분 F 검정</a></li>
<li class="chapter" data-level="3.4" data-path="chapter04.html"><a href="chapter04.html#선형-가설에-대한-검정"><i class="fa fa-check"></i><b>3.4</b> 선형 가설에 대한 검정</a></li>
<li class="chapter" data-level="3.5" data-path="chapter04.html"><a href="chapter04.html#변수변환"><i class="fa fa-check"></i><b>3.5</b> 변수변환</a></li>
<li class="chapter" data-level="3.6" data-path="chapter04.html"><a href="chapter04.html#다중공선성"><i class="fa fa-check"></i><b>3.6</b> 다중공선성</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="chapter04.html"><a href="chapter04.html#예제-4.14"><i class="fa fa-check"></i><b>3.6.1</b> 예제 4.14</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="compute.html"><a href="compute.html"><i class="fa fa-check"></i><b>4</b> 최소제곱의 계산법</a>
<ul>
<li class="chapter" data-level="4.1" data-path="compute.html"><a href="compute.html#촐레스키"><i class="fa fa-check"></i><b>4.1</b> 촐레스키</a></li>
<li class="chapter" data-level="4.2" data-path="compute.html"><a href="compute.html#qr"><i class="fa fa-check"></i><b>4.2</b> QR</a></li>
<li class="chapter" data-level="4.3" data-path="compute.html"><a href="compute.html#svd"><i class="fa fa-check"></i><b>4.3</b> SVD</a></li>
<li class="chapter" data-level="4.4" data-path="compute.html"><a href="compute.html#결과"><i class="fa fa-check"></i><b>4.4</b> 결과</a></li>
<li class="chapter" data-level="4.5" data-path="compute.html"><a href="compute.html#참고"><i class="fa fa-check"></i><b>4.5</b> 참고</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chapter05.html"><a href="chapter05.html"><i class="fa fa-check"></i><b>5</b> 자료에 대한 진단</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chapter05.html"><a href="chapter05.html#잔차-그림"><i class="fa fa-check"></i><b>5.1</b> 잔차 그림</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="chapter05.html"><a href="chapter05.html#부분회귀그림-partial-regression-plot-added-variable-plot"><i class="fa fa-check"></i><b>5.1.1</b> 부분회귀그림 (Partial regression plot; added variable plot)</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="chapter05.html"><a href="chapter05.html#자료-usedcars-에-대한-잔차-분석-예제-3.8-예제-5.3"><i class="fa fa-check"></i><b>5.2</b> 자료 <code>usedcars</code> 에 대한 잔차 분석 (예제 3.8, 예제 5.3)</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="chapter05.html"><a href="chapter05.html#잔차그림"><i class="fa fa-check"></i><b>5.2.1</b> 잔차그림</a></li>
<li class="chapter" data-level="5.2.2" data-path="chapter05.html"><a href="chapter05.html#잔차"><i class="fa fa-check"></i><b>5.2.2</b> 잔차</a></li>
<li class="chapter" data-level="5.2.3" data-path="chapter05.html"><a href="chapter05.html#영향점-측도"><i class="fa fa-check"></i><b>5.2.3</b> 영향점 측도</a></li>
<li class="chapter" data-level="5.2.4" data-path="chapter05.html"><a href="chapter05.html#부분회귀그림"><i class="fa fa-check"></i><b>5.2.4</b> 부분회귀그림</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="chapter05.html"><a href="chapter05.html#자료-houseprice-에-대한-잔차-분석-연습문제-5.9"><i class="fa fa-check"></i><b>5.3</b> 자료 <code>houseprice</code> 에 대한 잔차 분석 (연습문제 5.9)</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="chapter05.html"><a href="chapter05.html#잔차그림-1"><i class="fa fa-check"></i><b>5.3.1</b> 잔차그림</a></li>
<li class="chapter" data-level="5.3.2" data-path="chapter05.html"><a href="chapter05.html#잔차-1"><i class="fa fa-check"></i><b>5.3.2</b> 잔차</a></li>
<li class="chapter" data-level="5.3.3" data-path="chapter05.html"><a href="chapter05.html#영향점-측도-1"><i class="fa fa-check"></i><b>5.3.3</b> 영향점 측도</a></li>
<li class="chapter" data-level="5.3.4" data-path="chapter05.html"><a href="chapter05.html#부분회귀그림-1"><i class="fa fa-check"></i><b>5.3.4</b> 부분회귀그림</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="-2-.html"><a href="-2-.html"><i class="fa fa-check"></i><b>A</b> 과제 2 해답</a>
<ul>
<li class="chapter" data-level="A.1" data-path="-2-.html"><a href="-2-.html#section"><i class="fa fa-check"></i><b>A.1</b> 2.6</a></li>
<li class="chapter" data-level="A.2" data-path="-2-.html"><a href="-2-.html#section-1"><i class="fa fa-check"></i><b>A.2</b> 2.13</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="-2-.html"><a href="-2-.html#section-2"><i class="fa fa-check"></i><b>A.2.1</b> (1)</a></li>
<li class="chapter" data-level="A.2.2" data-path="-2-.html"><a href="-2-.html#section-3"><i class="fa fa-check"></i><b>A.2.2</b> (2)</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="-2-.html"><a href="-2-.html#section-4"><i class="fa fa-check"></i><b>A.3</b> 3.3</a></li>
<li class="chapter" data-level="A.4" data-path="-2-.html"><a href="-2-.html#section-5"><i class="fa fa-check"></i><b>A.4</b> 3.7</a>
<ul>
<li class="chapter" data-level="A.4.1" data-path="-2-.html"><a href="-2-.html#section-6"><i class="fa fa-check"></i><b>A.4.1</b> (1)</a></li>
<li class="chapter" data-level="A.4.2" data-path="-2-.html"><a href="-2-.html#section-7"><i class="fa fa-check"></i><b>A.4.2</b> (2)</a></li>
<li class="chapter" data-level="A.4.3" data-path="-2-.html"><a href="-2-.html#section-8"><i class="fa fa-check"></i><b>A.4.3</b> (3)</a></li>
<li class="chapter" data-level="A.4.4" data-path="-2-.html"><a href="-2-.html#section-9"><i class="fa fa-check"></i><b>A.4.4</b> (4)</a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="-2-.html"><a href="-2-.html#추가-문제"><i class="fa fa-check"></i><b>A.5</b> 추가 문제</a>
<ul>
<li class="chapter" data-level="A.5.1" data-path="-2-.html"><a href="-2-.html#추가-문제-1"><i class="fa fa-check"></i><b>A.5.1</b> 추가 문제 1</a></li>
<li class="chapter" data-level="A.5.2" data-path="-2-.html"><a href="-2-.html#추가-문제-2"><i class="fa fa-check"></i><b>A.5.2</b> 추가 문제 2</a></li>
<li class="chapter" data-level="A.5.3" data-path="-2-.html"><a href="-2-.html#추가-문제-3"><i class="fa fa-check"></i><b>A.5.3</b> 추가 문제 3</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">회귀모형 R 실습</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
\(
\newcommand{\bm}[1]{\boldsymbol{\mathbf{#1}}}
\newcommand{\pardiff}[2]{\frac{\partial #1}{\partial #2 }}
\newcommand{\pardiffl}[2]{{\partial #1}/{\partial #2 }}
\newcommand{\pardiffd}[2]{\frac{\partial^2 #1}{\partial #2^t \partial #2 }}
\newcommand{\pardiffdd}[3]{\frac{\partial^2 #1}{\partial #2 \partial #3 }}
\newcommand{\norm}[1]{\left\lVert#1\right\rVert}
\newcommand{\hatmat}{\bm X ({\bm X}^t {\bm X} )^{-1} {\bm X}^t}
\newcommand{\hatmatt}[1]{\bm X_{#1} ({\bm X}_{#1}^t {\bm X}_{#1})^{-1} {\bm X}_{#1}^t}
\)
<div id="과제-2-해답" class="section level1" number="6">
<h1><span class="header-section-number">부록 A: </span> 과제 2 해답</h1>
<div id="section" class="section level2" number="6.1">
<h2><span class="header-section-number">A.1</span> 2.6</h2>
<p>회귀계수의 분산을 작게 할 수록 더 정확한 추정이 가능하므로 설명 변수의 변동 <span class="math inline">\(\sum(x_i-\bar x)^2\)</span> 을 크게 하는 것이 좋다. 즉, 설명변수들이 평균으로 부터 많이 퍼져있게 배치하는 것이 좋다.</p>
</div>
<div id="section-1" class="section level2" number="6.2">
<h2><span class="header-section-number">A.2</span> 2.13</h2>
<div id="section-2" class="section level3" number="6.2.1">
<h3><span class="header-section-number">A.2.1</span> (1)</h3>
<p>이차원 조건부 정규 분포와 회귀계수간의 관계는 다음과 같다.</p>
<p><span class="math display">\[ \beta_1 = \rho \frac{\sigma_y}{\sigma_x}, \quad \beta_0 = \mu_y - \rho \frac{\sigma_y}{\sigma_x} \mu_x \]</span></p>
</div>
<div id="section-3" class="section level3" number="6.2.2">
<h3><span class="header-section-number">A.2.2</span> (2)</h3>
<p>이차원 조건부 정규 분포의 모수에 표본 추정량을 대입해보자.</p>
<p><span class="math display">\[\begin{align*}
\hat \rho \frac{\hat \sigma_y}{\hat \sigma_x}
        &amp; = \frac{\sum(y_i-\bar y)(x_i - \bar x)}{ \sqrt{\sum (y_i-\bar y)^2 \sum (x_i - \bar x)^2}}
         \frac{ \sqrt{\sum (y_i-\bar y)^2 /(n-1) }}{ \sqrt{\sum (x_i-\bar x)^2/(n-1) }} \\
         &amp; = \frac{\sum(y_i-\bar y)(x_i - \bar x)}{ \sum (x_i-\bar x)^2} \\
         &amp; = \hat \beta_1 \\        
\hat \mu_y - \hat \rho \frac{\hat \sigma_y}{\hat \sigma_x} \hat \mu_x
        &amp; = \bar y  -\hat \beta_1 \bar x \\
        &amp; = \hat \beta_0
\end{align*}\]</span></p>
</div>
</div>
<div id="section-4" class="section level2" number="6.3">
<h2><span class="header-section-number">A.3</span> 3.3</h2>
<p><span class="math display">\[
(X^t X)^{-1} = \frac{1}{n\sum X_i^2 -(\sum X_i)^2}  \begin{pmatrix}
\sum X_i^2 &amp; -\sum X_i \\
-\sum X_i &amp; n
\end{pmatrix}
= \frac{1}{n(\sum (X_i -\bar X)^2)}\begin{pmatrix}
\sum X_i^2 &amp; -\sum X_i \\
-\sum X_i &amp; n
\end{pmatrix}
\]</span></p>
<p><span class="math inline">\(Var(\hat \beta ) =\sigma^2 (X^t X)^{-1}\)</span>이므로 절편과 기울기의 추정량의 공분산은 다음과 같이 주어진다.</p>
<p><span class="math display">\[ 
Cov(\hat \beta_0, \hat \beta_1) =  - \sigma^2 
\frac{\sum X_i}{n(\sum (X_i -\bar X)^2)} 
= - \sigma^2 
\frac{\bar X}{ SS_{XX}}
\]</span></p>
<p>단순 회귀직선은 언제나 <span class="math inline">\((\bar X, \bar Y)\)</span> 점을 지나는 직선이다. 따라서 <span class="math inline">\(\bar X\)</span>가 양수인 경우에 기울기가 증가(감소)하면 절편이 감소(증가)한다.</p>
<p>아래의 그림은 <span class="math inline">\((\bar X, \bar Y)=(4,4)\)</span>을 지나는 여러 가지 회귀직선을
그린 그림으로서 절편과 기울기의 추정량에 대한 공분산이 음수인 것을 직관적으로 설명한다.</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="-2-.html#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">8</span>),<span class="fu">c</span>(<span class="sc">-</span><span class="dv">8</span>,<span class="dv">10</span>), <span class="at">type=</span><span class="st">&quot;n&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;X&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Y&quot;</span>)</span>
<span id="cb175-2"><a href="-2-.html#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="at">cex=</span><span class="fl">1.5</span>, <span class="at">pch=</span><span class="dv">2</span>)</span>
<span id="cb175-3"><a href="-2-.html#cb175-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb175-4"><a href="-2-.html#cb175-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb175-5"><a href="-2-.html#cb175-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">b=</span><span class="dv">1</span>, <span class="at">a=</span><span class="dv">0</span>)</span>
<span id="cb175-6"><a href="-2-.html#cb175-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">b=</span><span class="dv">2</span>, <span class="at">a=</span><span class="sc">-</span><span class="dv">4</span>)</span>
<span id="cb175-7"><a href="-2-.html#cb175-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">b=</span><span class="fl">0.5</span>, <span class="at">a=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="lmpractice_files/figure-html/unnamed-chunk-64-1.png" width="672" /></p>
</div>
<div id="section-5" class="section level2" number="6.4">
<h2><span class="header-section-number">A.4</span> 3.7</h2>
<div id="section-6" class="section level3" number="6.4.1">
<h3><span class="header-section-number">A.4.1</span> (1)</h3>
<p><span class="math display">\[
y = \begin{bmatrix}
2 \\
3 \\
1 \\
3 \\
4 \\
6 \\
3 \\
6 \\
\end{bmatrix}
\quad
X = \begin{bmatrix}
1 &amp; -1  &amp; -1 &amp; -1 \\
1 &amp; +1  &amp; -1 &amp; -1 \\
1 &amp; -1  &amp; +1 &amp; -1 \\
1 &amp; +1  &amp; +1 &amp; -1 \\
1 &amp; -1  &amp; -1 &amp; +1 \\
1 &amp; +1  &amp; -1 &amp; +1 \\
1 &amp; -1  &amp; +1 &amp; +1 \\
1 &amp; +1  &amp; +1 &amp; +1 \\
\end{bmatrix}
\]</span></p>
<p><span class="math display">\[ X^t X 
= \begin{bmatrix}
8 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 8 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 8 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 8\\
\end{bmatrix}
\]</span></p>
</div>
<div id="section-7" class="section level3" number="6.4.2">
<h3><span class="header-section-number">A.4.2</span> (2)</h3>
<p><span class="math display">\[ (X^t X)^{-1} 
= \begin{bmatrix}
1/8 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 1/8 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 1/8 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 1/8\\
\end{bmatrix}
\quad
 X^t y 
= \begin{bmatrix}
28\\
8 \\
-2 \\
10 \\
\end{bmatrix}
\]</span></p>
<p>따라서
<span class="math display">\[ 
\hat \beta =(X^t X)^{-1}  X^t y  = 
\begin{bmatrix}
3.5 \\
1 \\
-0.25 \\
1.25 \\
\end{bmatrix}
\]</span></p>
</div>
<div id="section-8" class="section level3" number="6.4.3">
<h3><span class="header-section-number">A.4.3</span> (3)</h3>
<p>만약 <span class="math inline">\(X_1\)</span>과 <span class="math inline">\(X_2\)</span>만 사용하는 회귀 모형의 계수 추정결과는 다음과 같다. <span class="math inline">\(X_3\)</span>를 모형에 포함할 때와 아닐 경우 모두 다른 독립변수에 대한
계수의 추정치는 같다.</p>
<p><span class="math display">\[ (X^t X)^{-1} 
= \begin{bmatrix}
1/8 &amp; 0 &amp; 0 \\
0 &amp; 1/8 &amp; 0 \\
0 &amp; 0 &amp; 1/8 \\
\end{bmatrix}
\quad
 X^t y 
= \begin{bmatrix}
28\\
8 \\
-2 \\
\end{bmatrix}
\quad
\hat \beta =(X^t X)^{-1}  X^t y  = 
\begin{bmatrix}
3.5 \\
1 \\
-0.25 \\
\end{bmatrix}
\]</span></p>
</div>
<div id="section-9" class="section level3" number="6.4.4">
<h3><span class="header-section-number">A.4.4</span> (4)</h3>
<p>이렇게 <span class="math inline">\(X_3\)</span>를 모형에 포함할 때와 아닐 경우 모두 다른 독립변수에 대한 계수의 추정치가 같은 이유는 <span class="math inline">\(X^t X\)</span>행렬이 대각행렬이기 때문이며 이는 각 독립변수(절편포함)의 열벡터들이 서로 직교하기 때문이다. 두 열벡터가 직교하는 것은 내적이 0이 된다는 것이다.</p>
<p>위의 계산결과들은 아래와 같이 R 프로그램을 이용하여 얻을 수 있다.</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="-2-.html#cb176-1" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb176-2"><a href="-2-.html#cb176-2" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb176-3"><a href="-2-.html#cb176-3" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb176-4"><a href="-2-.html#cb176-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">3</span>,<span class="dv">6</span>)</span>
<span id="cb176-5"><a href="-2-.html#cb176-5" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">y=</span>y, <span class="at">x1=</span>x1,<span class="at">x2=</span>x2,<span class="at">x3=</span>x3)</span>
<span id="cb176-6"><a href="-2-.html#cb176-6" aria-hidden="true" tabindex="-1"></a>lm3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span> x1<span class="sc">+</span>x2<span class="sc">+</span>x3, <span class="at">data=</span>dat1)</span>
<span id="cb176-7"><a href="-2-.html#cb176-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm3)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x1 + x2 + x3, data = dat1)
## 
## Residuals:
##          1          2          3          4          5          6          7          8 
##  5.000e-01 -5.000e-01  2.776e-17  8.049e-16  6.384e-16 -5.551e-17 -5.000e-01  5.000e-01 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   3.5000     0.1768  19.799 3.84e-05 ***
## x1            1.0000     0.1768   5.657  0.00481 ** 
## x2           -0.2500     0.1768  -1.414  0.23020    
## x3            1.2500     0.1768   7.071  0.00211 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.5 on 4 degrees of freedom
## Multiple R-squared:  0.9545, Adjusted R-squared:  0.9205 
## F-statistic:    28 on 3 and 4 DF,  p-value: 0.003815</code></pre>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="-2-.html#cb178-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(lm3)</span>
<span id="cb178-2"><a href="-2-.html#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(X) <span class="sc">%*%</span> X</span></code></pre></div>
<pre><code>##             (Intercept) x1 x2 x3
## (Intercept)           8  0  0  0
## x1                    0  8  0  0
## x2                    0  0  8  0
## x3                    0  0  0  8</code></pre>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="-2-.html#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(<span class="fu">t</span>(X) <span class="sc">%*%</span> X )</span></code></pre></div>
<pre><code>##             (Intercept)    x1    x2    x3
## (Intercept)       0.125 0.000 0.000 0.000
## x1                0.000 0.125 0.000 0.000
## x2                0.000 0.000 0.125 0.000
## x3                0.000 0.000 0.000 0.125</code></pre>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="-2-.html#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(<span class="fu">t</span>(X) <span class="sc">%*%</span> X) <span class="sc">%*%</span> <span class="fu">t</span>(X) <span class="sc">%*%</span> y</span></code></pre></div>
<pre><code>##              [,1]
## (Intercept)  3.50
## x1           1.00
## x2          -0.25
## x3           1.25</code></pre>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="-2-.html#cb184-1" aria-hidden="true" tabindex="-1"></a>lm4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span> x1<span class="sc">+</span>x2, <span class="at">data=</span>dat1)</span>
<span id="cb184-2"><a href="-2-.html#cb184-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm4)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x1 + x2, data = dat1)
## 
## Residuals:
##     1     2     3     4     5     6     7     8 
## -0.75 -1.75 -1.25 -1.25  1.25  1.25  0.75  1.75 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)   3.5000     0.5809   6.025  0.00181 **
## x1            1.0000     0.5809   1.721  0.14581   
## x2           -0.2500     0.5809  -0.430  0.68487   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.643 on 5 degrees of freedom
## Multiple R-squared:  0.3864, Adjusted R-squared:  0.1409 
## F-statistic: 1.574 on 2 and 5 DF,  p-value: 0.295</code></pre>
</div>
</div>
<div id="추가-문제" class="section level2" number="6.5">
<h2><span class="header-section-number">A.5</span> 추가 문제</h2>
<div id="추가-문제-1" class="section level3" number="6.5.1">
<h3><span class="header-section-number">A.5.1</span> 추가 문제 1</h3>
<p>중회귀 모형 <span class="math inline">\(\bm y = \bm X \bm \beta\)</span> 에서 회귀제곱합 <span class="math inline">\(SSR\)</span>의 기대값을 구하시오.</p>
<span class="math display">\[\begin{align*}
E(SSR) &amp;= E[{\bm y}^t (\bm H - \bm 1 \bm 1^t /n)  \bm y] \\
  &amp; = (\bm X \bm \beta)^t (\bm H - \bm 1 \bm 1^t /n) (\bm X \bm \beta) + tr[(\bm H - \bm 1 \bm 1^t /n)(\sigma^2 \bm I )] \\
  &amp; = {\bm \beta}^t \bm X^t (\bm H - \bm 1 \bm 1^t /n) \bm X \bm \beta + \sigma^2 tr(\bm H - \bm 1 \bm 1^t /n) \\
  &amp; = {\bm \beta}^t ( \bm X^t \bm H \bm X - \bm X^t \bm 1 \bm 1^t \bm X /n ) \bm \beta  + \sigma^2 
  [ tr(\bm H) - tr (\bm 1 \bm 1^t) /n ] \\
  &amp; = {\bm \beta}^t (\bm X^t  \bm X - \bm X^t \bm 1 \bm 1^t \bm X /n  ) \bm \beta + \sigma^2 (p-1) \\
  &amp; = {\bm \beta}^t \bm X^t (  \bm I  - \bm 1 \bm 1^t /n  ) \bm X  \bm \beta + \sigma^2 (p-1)
\end{align*}\]</span>
</div>
<div id="추가-문제-2" class="section level3" number="6.5.2">
<h3><span class="header-section-number">A.5.2</span> 추가 문제 2</h3>
<p>최소제곱 추정량 <span class="math inline">\(\hat {\bm \beta}\)</span>와 잔차 벡터 <span class="math inline">\(\bm y - \bm X \hat {\bm \beta}\)</span>의 공분산 행렬이 <span class="math inline">\(\bm 0\)</span>임을 보이시오.</p>
<p>다음은 반응변수 벡터에 대한 두 개의 선형변환 <span class="math inline">\(\bm A \bm y\)</span> 과 <span class="math inline">\(\bm B \bm y\)</span>의 공분산을 구하는 공식이다.</p>
<span class="math display">\[\begin{align*}
Cov(\bm A \bm y, \bm B \bm y) &amp; = E [(\bm A \bm y -E(\bm A \bm y) )(\bm B \bm y - E(\bm B \bm y)^t)] \\
&amp; = \bm A E [(\bm y -E(\bm y) )(\bm y -E(\bm y) )^t ] \bm B^t \\
&amp; = \bm A (\sigma^2 \bm I) \bm B^t \\
&amp; = \sigma^2 \bm A \bm B^t 
\end{align*}\]</span>
<p>위의 문제에서</p>
<p><span class="math display">\[ \hat {\bm \beta} = (\bm X^t \bm X)^{-1} \bm X^t \bm y, \quad \bm y - \bm X \hat {\bm \beta} = (\bm I - \bm H) \bm y \]</span></p>
<p>이므로 다음과 같은 결과를 얻는다. 따라서 최소제곱 추정량 <span class="math inline">\(\hat {\bm \beta}\)</span>와 잔차 벡터 <span class="math inline">\(\bm y - \bm X \hat {\bm \beta}\)</span>의 공분산 행렬이 <span class="math inline">\(\bm 0\)</span>이다.</p>
<p><span class="math display">\[ (\bm X^t \bm X)^{-1} \bm X^t (\bm I - \bm H)  = \bm 0 \]</span></p>
</div>
<div id="추가-문제-3" class="section level3" number="6.5.3">
<h3><span class="header-section-number">A.5.3</span> 추가 문제 3</h3>
<p><span class="math inline">\(n\)</span>개의 확률변수 <span class="math inline">\(y_1, y_2, \dots, y_n\)</span> 이 독립적으로 <span class="math inline">\(N(\mu, \sigma^2)\)</span>에서 추출되었다.</p>
<ul>
<li>다음의 방정식이 성립함을 보이시오.</li>
</ul>
<p><span class="math display">\[ \sum_{i=1}^n (y_i -\bar y)^2 = \sum_{i=2}^n (y_i -{\bar y}^*)^2 + \frac{n-1}{n}(y_1 - {\bar y}^*)^2 \]</span>
여기서 <span class="math inline">\({\bar y}^* = \sum_{i=2}^n y_i/(n-1)\)</span></p>
<ul>
<li>다음 주어진 통계량 <span class="math inline">\(Q\)</span> 의 분포를 구하시오.</li>
</ul>
<p><span class="math display">\[ Q =\frac{n-1}{n}  \frac{(y_1 - {\bar y}^*)^2 }{\sigma^2}  \]</span></p>
<p>먼저 몇 개의 필요한 공식을 유도해보자.</p>
<span class="math display">\[\begin{align*}
y_1 - \bar y &amp; = \frac{n-1}{n} ( y_1 - \bar y^*) \\
\bar y^* - \bar y &amp; = \frac{1}{n}(\bar y^* - y_1) 
\end{align*}\]</span>
<p>이제 <span class="math inline">\(\sum_{i=1}^y (y_i - \bar y)^2\)</span>을 분해해 보자</p>
<span class="math display">\[\begin{align*}
\sum_{i=1}^y (y_i - \bar y)^2 &amp; = (y_1 - \bar y)^2 + \sum_{i=2}^n (y_i -\bar y^* + \bar y^* - \bar y)^2 \\
  &amp; = \frac{(n-1)^2}{n^2} ( y_1 - \bar y^*)^2 +  \sum_{i=2}^n  (y_i -\bar y^*)^2 + \sum{i=2}^n (\bar y^* - \bar y)^2 + 2 \sum_{i=2}^n  (y_i -\bar y^*) (\bar y^* - \bar y) \\
  &amp; = \frac{(n-1)^2}{n^2} ( y_1 - \bar y^*)^2 + \sum_{i=2}^n  (y_i -\bar y^*)^2  + \frac{n-1}{n^2} (\bar y^* - y_1)^2 + 0 \\
  &amp; = \sum_{i=2}^n  (y_i -\bar y^*)^2  + \frac{n-1}{n} (\bar y^* - y_1)^2 
\end{align*}\]</span>
<p>이제 다음과 같이 두 개의 통계량이 카이 제곱 분포를 따르므로</p>
<p><span class="math display">\[ \sum_{i=1}^n (y_i -\bar y)^2/\sigma^2 \sim \chi^2(n-1), \quad \sum_{i=2}^n (y_i -{\bar y}^*)^2/\sigma^2 \sim \chi^2(n-2) \]</span></p>
<p>다음 통계량 <span class="math inline">\(Q\)</span> 는 <span class="math inline">\(\chi^2(1)\)</span> 을 따른다 (교수 강의모트 Theorem C.3) .</p>
<p><span class="math display">\[ Q =\frac{n-1}{n}  \frac{(y_1 - {\bar y}^*)^2 }{\sigma^2} \]</span></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapter05.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["lmpractice.pdf", "lmpractice.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
