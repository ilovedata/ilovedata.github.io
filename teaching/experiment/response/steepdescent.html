<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>제 2 장 최대경사법 | 반응표면분석</title>
  <meta name="description" content="20201년 1학기 서울시립대학교 통계학과에서 개설한 실험계획의 강의노트입니다." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="제 2 장 최대경사법 | 반응표면분석" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="20201년 1학기 서울시립대학교 통계학과에서 개설한 실험계획의 강의노트입니다." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="제 2 장 최대경사법 | 반응표면분석" />
  
  <meta name="twitter:description" content="20201년 1학기 서울시립대학교 통계학과에서 개설한 실험계획의 강의노트입니다." />
  

<meta name="author" content="서울시립대 통계학과" />


<meta name="date" content="2021-05-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="responseintro.html"/>
<link rel="next" href="secondorder.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">반응표면분석</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>서문</a></li>
<li class="chapter" data-level="1" data-path="responseintro.html"><a href="responseintro.html"><i class="fa fa-check"></i><b>1</b> 반응표면 분석 개요</a>
<ul>
<li class="chapter" data-level="1.1" data-path="responseintro.html"><a href="responseintro.html#실험계획의-절차"><i class="fa fa-check"></i><b>1.1</b> 실험계획의 절차</a></li>
<li class="chapter" data-level="1.2" data-path="responseintro.html"><a href="responseintro.html#반응표면분석의-목적"><i class="fa fa-check"></i><b>1.2</b> 반응표면분석의 목적</a></li>
<li class="chapter" data-level="1.3" data-path="responseintro.html"><a href="responseintro.html#반응표면분석의-절차"><i class="fa fa-check"></i><b>1.3</b> 반응표면분석의 절차</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="steepdescent.html"><a href="steepdescent.html"><i class="fa fa-check"></i><b>2</b> 최대경사법</a>
<ul>
<li class="chapter" data-level="2.1" data-path="steepdescent.html"><a href="steepdescent.html#개요"><i class="fa fa-check"></i><b>2.1</b> 개요</a></li>
<li class="chapter" data-level="2.2" data-path="steepdescent.html"><a href="steepdescent.html#절-자료와-변환"><i class="fa fa-check"></i><b>2.2</b> 9.2절 자료와 변환</a></li>
<li class="chapter" data-level="2.3" data-path="steepdescent.html"><a href="steepdescent.html#선형회귀식"><i class="fa fa-check"></i><b>2.3</b> 선형회귀식</a></li>
<li class="chapter" data-level="2.4" data-path="steepdescent.html"><a href="steepdescent.html#최대경사법"><i class="fa fa-check"></i><b>2.4</b> 최대경사법</a></li>
<li class="chapter" data-level="2.5" data-path="steepdescent.html"><a href="steepdescent.html#패키지-rsm"><i class="fa fa-check"></i><b>2.5</b> 패키지 <code>rsm</code></a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="steepdescent.html"><a href="steepdescent.html#일차-선형식의-적합"><i class="fa fa-check"></i><b>2.5.1</b> 일차 선형식의 적합</a></li>
<li class="chapter" data-level="2.5.2" data-path="steepdescent.html"><a href="steepdescent.html#등고선-그림"><i class="fa fa-check"></i><b>2.5.2</b> 등고선 그림</a></li>
<li class="chapter" data-level="2.5.3" data-path="steepdescent.html"><a href="steepdescent.html#최적-실험점-탐색"><i class="fa fa-check"></i><b>2.5.3</b> 최적 실험점 탐색</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="steepdescent.html"><a href="steepdescent.html#변량이-3개-이상인-경우"><i class="fa fa-check"></i><b>2.6</b> 변량이 3개 이상인 경우</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="secondorder.html"><a href="secondorder.html"><i class="fa fa-check"></i><b>3</b> 2차 반응표면</a>
<ul>
<li class="chapter" data-level="3.1" data-path="secondorder.html"><a href="secondorder.html#개요-1"><i class="fa fa-check"></i><b>3.1</b> 개요</a></li>
<li class="chapter" data-level="3.2" data-path="secondorder.html"><a href="secondorder.html#차-다항-모형"><i class="fa fa-check"></i><b>3.2</b> 2차 다항 모형</a></li>
<li class="chapter" data-level="3.3" data-path="secondorder.html"><a href="secondorder.html#이차-반응표면의-모양"><i class="fa fa-check"></i><b>3.3</b> 이차 반응표면의 모양</a></li>
<li class="chapter" data-level="3.4" data-path="secondorder.html"><a href="secondorder.html#최적점과-정상점"><i class="fa fa-check"></i><b>3.4</b> 최적점과 정상점</a></li>
<li class="chapter" data-level="3.5" data-path="secondorder.html"><a href="secondorder.html#차-다항식의-표현"><i class="fa fa-check"></i><b>3.5</b> 2차 다항식의 표현</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="canonocal.html"><a href="canonocal.html"><i class="fa fa-check"></i><b>4</b> 2차모형의 정준분석</a>
<ul>
<li class="chapter" data-level="4.1" data-path="canonocal.html"><a href="canonocal.html#개요-2"><i class="fa fa-check"></i><b>4.1</b> 개요</a></li>
<li class="chapter" data-level="4.2" data-path="canonocal.html"><a href="canonocal.html#이차형식"><i class="fa fa-check"></i><b>4.2</b> 이차형식</a></li>
<li class="chapter" data-level="4.3" data-path="canonocal.html"><a href="canonocal.html#차-다항식의-정준형식"><i class="fa fa-check"></i><b>4.3</b> 2차 다항식의 정준형식</a></li>
<li class="chapter" data-level="4.4" data-path="canonocal.html"><a href="canonocal.html#변환된-변수"><i class="fa fa-check"></i><b>4.4</b> 변환된 변수</a></li>
<li class="chapter" data-level="4.5" data-path="canonocal.html"><a href="canonocal.html#예제-2개의-독립-변수"><i class="fa fa-check"></i><b>4.5</b> 예제: 2개의 독립 변수</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="expriment.html"><a href="expriment.html"><i class="fa fa-check"></i><b>5</b> 최적점 탐색을 위한 실험계획</a>
<ul>
<li class="chapter" data-level="5.1" data-path="expriment.html"><a href="expriment.html#개요-3"><i class="fa fa-check"></i><b>5.1</b> 개요</a></li>
<li class="chapter" data-level="5.2" data-path="expriment.html"><a href="expriment.html#중심합성설계"><i class="fa fa-check"></i><b>5.2</b> 중심합성설계</a></li>
<li class="chapter" data-level="5.3" data-path="expriment.html"><a href="expriment.html#회전가능-중심합성설계"><i class="fa fa-check"></i><b>5.3</b> 회전가능 중심합성설계</a></li>
<li class="chapter" data-level="5.4" data-path="expriment.html"><a href="expriment.html#box-benken-설계"><i class="fa fa-check"></i><b>5.4</b> Box-Benken 설계</a></li>
<li class="chapter" data-level="5.5" data-path="expriment.html"><a href="expriment.html#계획법에-따른-실험점의-개수"><i class="fa fa-check"></i><b>5.5</b> 계획법에 따른 실험점의 개수</a></li>
<li class="chapter" data-level="5.6" data-path="expriment.html"><a href="expriment.html#r-을-이용한-실험계획"><i class="fa fa-check"></i><b>5.6</b> R 을 이용한 실험계획</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="expriment.html"><a href="expriment.html#회전가능-중심합성설계-1"><i class="fa fa-check"></i><b>5.6.1</b> 회전가능 중심합성설계</a></li>
<li class="chapter" data-level="5.6.2" data-path="expriment.html"><a href="expriment.html#box-benken-설계-1"><i class="fa fa-check"></i><b>5.6.2</b> Box-Benken 설계</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="example.html"><a href="example.html"><i class="fa fa-check"></i><b>6</b> 이차반응표면분석 사례</a>
<ul>
<li class="chapter" data-level="6.1" data-path="example.html"><a href="example.html#개요-4"><i class="fa fa-check"></i><b>6.1</b> 개요</a></li>
<li class="chapter" data-level="6.2" data-path="example.html"><a href="example.html#실험의-목적과-개요"><i class="fa fa-check"></i><b>6.2</b> 실험의 목적과 개요</a></li>
<li class="chapter" data-level="6.3" data-path="example.html"><a href="example.html#중심합성설계의-실험점-생성"><i class="fa fa-check"></i><b>6.3</b> 중심합성설계의 실험점 생성</a></li>
<li class="chapter" data-level="6.4" data-path="example.html"><a href="example.html#실험자료-읽어오기"><i class="fa fa-check"></i><b>6.4</b> 실험자료 읽어오기</a></li>
<li class="chapter" data-level="6.5" data-path="example.html"><a href="example.html#차-다항식-모형의-적합"><i class="fa fa-check"></i><b>6.5</b> 2차 다항식 모형의 적합</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="example.html"><a href="example.html#모형의-적합"><i class="fa fa-check"></i><b>6.5.1</b> 모형의 적합</a></li>
<li class="chapter" data-level="6.5.2" data-path="example.html"><a href="example.html#등고선과-3차원-그림"><i class="fa fa-check"></i><b>6.5.2</b> 등고선과 3차원 그림</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="example.html"><a href="example.html#변수-선택"><i class="fa fa-check"></i><b>6.6</b> 변수 선택</a></li>
<li class="chapter" data-level="6.7" data-path="example.html"><a href="example.html#최종모형-선택"><i class="fa fa-check"></i><b>6.7</b> 최종모형 선택</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="example.html"><a href="example.html#최종모형의-선택과-적합"><i class="fa fa-check"></i><b>6.7.1</b> 최종모형의 선택과 적합</a></li>
<li class="chapter" data-level="6.7.2" data-path="example.html"><a href="example.html#등고선과-3차원-그림-1"><i class="fa fa-check"></i><b>6.7.2</b> 등고선과 3차원 그림</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="matrixalgebra.html"><a href="matrixalgebra.html"><i class="fa fa-check"></i><b>A</b> 행렬 기초 이론</a>
<ul>
<li class="chapter" data-level="A.1" data-path="matrixalgebra.html"><a href="matrixalgebra.html#직교행렬"><i class="fa fa-check"></i><b>A.1</b> 직교행렬</a></li>
<li class="chapter" data-level="A.2" data-path="matrixalgebra.html"><a href="matrixalgebra.html#고유치와-고유벡터"><i class="fa fa-check"></i><b>A.2</b> 고유치와 고유벡터</a></li>
<li class="chapter" data-level="A.3" data-path="matrixalgebra.html"><a href="matrixalgebra.html#대칭행렬의-대각화"><i class="fa fa-check"></i><b>A.3</b> 대칭행렬의 대각화</a></li>
<li class="chapter" data-level="A.4" data-path="matrixalgebra.html"><a href="matrixalgebra.html#이차형식-1"><i class="fa fa-check"></i><b>A.4</b> 이차형식</a></li>
<li class="chapter" data-level="A.5" data-path="matrixalgebra.html"><a href="matrixalgebra.html#멱등행렬"><i class="fa fa-check"></i><b>A.5</b> 멱등행렬</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">반응표면분석</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
\(
\newcommand{\bm}[1]{\boldsymbol{\mathbf{#1}}}
\newcommand{\pardiff}[2]{\frac{\partial #1}{\partial #2 }}
\newcommand{\pardiffl}[2]{{\partial #1}/{\partial #2 }}
\newcommand{\pardiffd}[2]{\frac{\partial^2 #1}{\partial #2^t \partial #2 }}
\newcommand{\pardiffdd}[3]{\frac{\partial^2 #1}{\partial #2 \partial #3 }}
\)
<div id="steepdescent" class="section level1" number="2">
<h1><span class="header-section-number">제 2 장</span> 최대경사법</h1>
<div id="개요" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> 개요</h2>
<ul>
<li><p>초기 실험에서는 실험에서 고려하는 계량인자들의 관심 영역이 반응변수의 최적값을 가지는 영역에서 멀리 떨어져 있는 경우가 흔하다.</p></li>
<li><p>따라서 초기 실험에서는 최적의 영역으로 이동하기 위한 계량인자들의 방향을 알아내는 것이 중요하다.</p></li>
<li><p><strong>간단한 초기 실험의 결과를 이용하여 계량인자들의 값을 최적점 근처로 순차적으로 이동시킬 수 있는 쉽고 경제적인 절차가 필요하다.</strong></p></li>
<li><p>주어진 선형모형에서 계량인자들의 값을 이동시킬 수 있는 간단한 방법들 중의 하나는 <strong>최대경사법(method of steepest ascent)</strong> 이다.</p></li>
</ul>
</div>
<div id="절-자료와-변환" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> 9.2절 자료와 변환</h2>
<p>교과서 9.2 절에 나오는 실험 자료를 고려해 보자. 화학공장에서 공정의 수율(<span class="math inline">\(y\)</span>)을 최적화하는 공정조건을 찾는 실험자가 관심이 있는 시간(<span class="math inline">\(x_1\)</span>, <code>time</code>)의 범위는 30-40분 이고 온도(<span class="math inline">\(x_2\)</span>, <code>temp</code>)의 범위는 160-180도 라고 하자.
이제 주어진 시간과 온도에 따라서 실험을 7번 수행하였으며 결과 자료는 다음과 같다.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="steepdescent.html#cb2-1" aria-hidden="true" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">30</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">40</span>,<span class="dv">35</span>,<span class="dv">35</span>,<span class="dv">35</span>)</span>
<span id="cb2-2"><a href="steepdescent.html#cb2-2" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">160</span>, <span class="dv">180</span>, <span class="dv">160</span>, <span class="dv">180</span>, <span class="dv">170</span>, <span class="dv">170</span>, <span class="dv">170</span>)</span>
<span id="cb2-3"><a href="steepdescent.html#cb2-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">72.5</span>, <span class="fl">74.2</span>, <span class="fl">76.3</span>, <span class="fl">77.0</span>, <span class="fl">74.8</span>, <span class="fl">75.6</span>, <span class="fl">75.2</span>)</span>
<span id="cb2-4"><a href="steepdescent.html#cb2-4" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">time=</span>time, <span class="at">temp=</span>temp, <span class="at">y=</span>y)</span>
<span id="cb2-5"><a href="steepdescent.html#cb2-5" aria-hidden="true" tabindex="-1"></a>df1 <span class="sc">%&gt;%</span>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">&#39;교과서 9.2절 실험자료&#39;</span>) <span class="sc">%&gt;%</span> <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">&quot;striped&quot;</span>, <span class="at">full_width =</span> F, <span class="at">position =</span> <span class="st">&quot;center&quot;</span>)</span></code></pre></div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-2">표 2.1: </span>교과서 9.2절 실험자료
</caption>
<thead>
<tr>
<th style="text-align:right;">
time
</th>
<th style="text-align:right;">
temp
</th>
<th style="text-align:right;">
y
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
160
</td>
<td style="text-align:right;">
72.5
</td>
</tr>
<tr>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
180
</td>
<td style="text-align:right;">
74.2
</td>
</tr>
<tr>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
160
</td>
<td style="text-align:right;">
76.3
</td>
</tr>
<tr>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
180
</td>
<td style="text-align:right;">
77.0
</td>
</tr>
<tr>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
170
</td>
<td style="text-align:right;">
74.8
</td>
</tr>
<tr>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
170
</td>
<td style="text-align:right;">
75.6
</td>
</tr>
<tr>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
170
</td>
<td style="text-align:right;">
75.2
</td>
</tr>
</tbody>
</table>
<p>반응표면분석에서는 고려하는 변량의 범위를 <span class="math inline">\((-1,1)\)</span> 로 변환하는 작업을 먼저 수행한다. 위의 자료에서 시간과 온도의 범위를 <span class="math inline">\((-1,1)\)</span>로 변환하기 위하여 다음과 같은 식을 적용한다.</p>
<p><span class="math display">\[ x_1 = \frac{\text{time} - 35}{5}, \quad x_2 = \frac{\text{temp} - 170}{10} \]</span></p>
<p>위와 같은 변환은 패키지 <code>rsm</code> 에 있는 함수 <code>coded.data</code>를 사용해서 쉽게 수행할 수 있다.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="steepdescent.html#cb3-1" aria-hidden="true" tabindex="-1"></a>df11 <span class="ot">&lt;-</span> <span class="fu">coded.data</span>(df1, x1 <span class="sc">~</span> (time <span class="sc">-</span> <span class="dv">35</span>)<span class="sc">/</span><span class="dv">5</span>, x2 <span class="sc">~</span> (temp <span class="sc">-</span> <span class="dv">170</span>)<span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb3-2"><a href="steepdescent.html#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(df11)</span></code></pre></div>
<pre><code>## [1] &quot;coded.data&quot; &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="steepdescent.html#cb5-1" aria-hidden="true" tabindex="-1"></a>df11 </span></code></pre></div>
<pre><code>##   time temp    y
## 1   30  160 72.5
## 2   30  180 74.2
## 3   40  160 76.3
## 4   40  180 77.0
## 5   35  170 74.8
## 6   35  170 75.6
## 7   35  170 75.2
## 
## Data are stored in coded form using these coding formulas ...
## x1 ~ (time - 35)/5
## x2 ~ (temp - 170)/10</code></pre>
<p>위에서 변환된 자료 <code>df11</code> 는 변환된 이름 <code>x1</code> 과 <code>x2</code> 로 자료가 저장되어 있지만 원래 변수의 이름 <code>time</code> 과 <code>temp</code> 도 특정한 함수에서 사용이 가능한다.</p>
<p>9.2 장 자료에서 7번 실험을 수행하는 경우 고려한 실험점(experiment point)은 정사각형의 각 꼭지점에서 하나의 관측값을 얻고 중심점 <span class="math inline">\((0,0)\)</span> 에서 3개의 실험값을 얻었다.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="steepdescent.html#cb7-1" aria-hidden="true" tabindex="-1"></a>df11 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(time, temp)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>)  <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb7-2"><a href="steepdescent.html#cb7-2" aria-hidden="true" tabindex="-1"></a>df11 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(x1, x2)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>)  <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-4"></span>
<img src="responsesurface_files/figure-html/unnamed-chunk-4-1.png" alt="실험점의 배치" width="50%" /><img src="responsesurface_files/figure-html/unnamed-chunk-4-2.png" alt="실험점의 배치" width="50%" />
<p class="caption">
그림 2.1: 실험점의 배치
</p>
</div>
<p>변환된 자료 <code>x1</code> 과 <code>x2</code> 의 값으로 부터 원래 자료의 값을 얻는 방법은 함수 <code>code2val()</code>을 사용한다. 예를 들어
<code>x1 = 0.5</code> , <code>x2 = 0.0</code> 으로 코딩된 원래 자료 <code>time</code> 과 <code>temp</code> 의 값은 다음과 같이 얻을 수 있다.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="steepdescent.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">code2val</span>(<span class="fu">data.frame</span>(<span class="at">x1 =</span> <span class="fu">c</span>(<span class="fl">0.5</span>), <span class="at">x2 =</span> <span class="fu">c</span>(<span class="fl">0.0</span>)), <span class="fu">codings</span>(df11))</span></code></pre></div>
<pre><code>##   time temp
## 1 37.5  170</code></pre>
</div>
<div id="선형회귀식" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> 선형회귀식</h2>
<p>다음은 반응변수 <span class="math inline">\(y\)</span> 를 에측하는 모형으로 두 개의 변량인자 <span class="math inline">\(x_1\)</span>과 <span class="math inline">\(x_2\)</span> 를 가지는 다음과 같은 일차선형 모형을 고려하자.</p>
<p><span class="math display" id="eq:linearmodel">\[\begin{equation}
y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 +  e 
\tag{2.1}
\end{equation}\]</span></p>
<p>주어진 자료를 이용하여 위의 일차선형 모형의 회귀계수들을 추정하면 반응변수의 평균 <span class="math inline">\(E(y|x)\)</span> 에 대한 다음과 같은 예측식을 얻을 수 있다.</p>
<p><span class="math display" id="eq:linearpred">\[\begin{equation}
\widehat {E(y|x)} = \hat y = \hat \beta_0 + \hat \beta_1 x_1 + \hat \beta_2 x_2
\tag{2.2}
\end{equation}\]</span></p>
<p>변환된 <span class="math inline">\(x_1\)</span> 과 <span class="math inline">\(x_2\)</span> 가 저장된 데이터 프레임 <code>df11</code> 에 있는 자료를 이용하여 일차선형 모형을 적합한 결과는 다음과 같다.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="steepdescent.html#cb10-1" aria-hidden="true" tabindex="-1"></a>lmdf11 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data=</span>df11)</span>
<span id="cb10-2"><a href="steepdescent.html#cb10-2" aria-hidden="true" tabindex="-1"></a>equatiomatic<span class="sc">::</span><span class="fu">extract_eq</span>(lmdf11, <span class="at">intercept =</span> <span class="st">&quot;beta&quot;</span>, <span class="at">use_coefs =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><span class="math display">\[
\operatorname{\widehat{y}} = 75.09 + 1.65(\operatorname{x1}) + 0.6(\operatorname{x2})
\]</span></p>
<p>예측식 <a href="steepdescent.html#eq:linearpred">(2.2)</a> 를 3차원 공간에 표시하면 다음과 같은 평면으로 나타나게 된다. 패키지 <code>scatterplot3d</code> 의 함수
<code>scatterplot3d()</code>를 이용하여 3차원 산포도와 추정된 선형식을 그릴 수 있다.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="steepdescent.html#cb11-1" aria-hidden="true" tabindex="-1"></a>s3d <span class="ot">&lt;-</span> <span class="fu">scatterplot3d</span>(<span class="fu">as.data.frame</span>(df11), <span class="at">type =</span> <span class="st">&quot;h&quot;</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">angle=</span><span class="dv">55</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">xlab=</span><span class="st">&quot;x1&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;x2&quot;</span>)</span>
<span id="cb11-2"><a href="steepdescent.html#cb11-2" aria-hidden="true" tabindex="-1"></a>s3d<span class="sc">$</span><span class="fu">plane3d</span>(lmdf11)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:plot4"></span>
<img src="responsesurface_files/figure-html/plot4-1.png" alt="일차 선형식" width="70%" />
<p class="caption">
그림 2.2: 일차 선형식
</p>
</div>
<p>위에서 적합된 예측식 <a href="steepdescent.html#eq:linearpred">(2.2)</a> 을 함수 <code>contour.lm()</code>을 이용하여 등고선 그림으로 나타내면 다음 그림과 같다.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="steepdescent.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contour.lm</span>(lmdf11, x2<span class="sc">~</span>x1, <span class="at">labcex=</span><span class="fl">1.4</span> )</span>
<span id="cb12-2"><a href="steepdescent.html#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>, <span class="dv">0</span>), <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">cex=</span><span class="fl">1.3</span>, <span class="at">pch=</span><span class="dv">19</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:plot5"></span>
<img src="responsesurface_files/figure-html/plot5-1.png" alt="일차 선형식" width="70%" />
<p class="caption">
그림 2.3: 일차 선형식
</p>
</div>
</div>
<div id="최대경사법" class="section level2" number="2.4">
<h2><span class="header-section-number">2.4</span> 최대경사법</h2>
<p>이제 반응변수의 변화에 대한 선형 예측식이 <a href="steepdescent.html#eq:linearpred">(2.2)</a> 로 주어진 경우 반응변수가 가장 크게 증가하는
방향을 2차원 공간 <span class="math inline">\((x_1, x_2)\)</span>에서 찾아보자. 이렇게 공간에서 다변량 함수의 변화가 가장 크게 변하는 방향을 찾는 방법을
최대경사법(method of steepest ascent)이라고 부르며 이는 기울기 하강법(gradient descent method)의 반대 방법이다.</p>
<p>이변량 함수 <span class="math inline">\(f(x_1, x_2)\)</span> 에 대한 기울기 벡터(gradient) <span class="math inline">\(\nabla f\)</span>는
다음과 같이 각 축에 대한 부분 미분(partial derivative)로 이루어진 벡터이다.</p>
<p><span class="math display">\[\begin{equation*}
\nabla f  =  \nabla f (x_1, x_2)  =
\begin{bmatrix} 
\pardiff{f(x_1, x_2)}{x_1} \\
\pardiff{f(x_1, x_2)}{x_2} 
\end{bmatrix}
\end{equation*}\]</span></p>
<p>기울기 벡터 <span class="math inline">\(\nabla f\)</span> 에 대한 기하학적 의미는 다음과 같은 그림으로 나타낼 수 있으며 <span class="math inline">\(\nabla f\)</span>는 주어진 점에서
함수 <span class="math inline">\(f\)</span>가 가장 빨리 증가하는 방향을 의미한다. 따라서 기울기 벡터 <span class="math inline">\(\nabla f\)</span> 를 최대 경사(steepest ascent) 벡터라고 부른다.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-7"></span>
<img src="myimages/gradient2.png" alt="기울기 벡터의 기하학적 의미" width="70%" />
<p class="caption">
그림 2.4: 기울기 벡터의 기하학적 의미
</p>
</div>
<p>선형 예측식 <a href="steepdescent.html#eq:linearpred">(2.2)</a> 이 주어진 경우 2차원 공간 <span class="math inline">\((x_1, x_2)\)</span>에서 반응변수가 가장 크게 증가하는
방향, 즉 최대경사 방향 <span class="math inline">\(\nabla f\)</span> 은 다음과 같이 주어진다.</p>
<p><span class="math display" id="eq:steepacend">\[\begin{equation}
\nabla f = 
\begin{bmatrix} 
\pardiff{f(x_1, x_2)}{x1} \\
\pardiff{f(x_1, x_2)}{x2} \\
\end{bmatrix}
=
\begin{bmatrix} 
\pardiff{(\hat \beta_0 + \hat \beta_1 x_1 + \hat \beta_2 x_2)}{x_1} \\
\pardiff{(\hat \beta_0 + \hat \beta_1 x_1 + \hat \beta_2 x_2)}{x_2} 
\end{bmatrix} 
=
\begin{bmatrix} 
\hat \beta_1  \\
\hat \beta_2 
\end{bmatrix}
\tag{2.3}
\end{equation}\]</span></p>
<p>따라서 9.2절의 실험자료에 대하여 적합한 모형식을 이용하면 최대경사 벡터 <span class="math inline">\(\nabla f\)</span> 는 다음과 같이 주어진다.</p>
<p><span class="math display" id="eq:steepacenddata">\[\begin{equation}
\nabla f = 
\begin{bmatrix} 
1.65  \\
0.06 
\end{bmatrix}
\tag{2.4}
\end{equation}\]</span></p>
<p>위의 최대경사 벡터 <span class="math inline">\(\nabla f\)</span>은 적합한 모형식에서 <span class="math inline">\(x_1\)</span>과 <span class="math inline">\(x_2\)</span> 가 1 단위 만큼 증가할 때 반응변수의 변화를 나타내는 회귀계수 <span class="math inline">\(\hat \beta_1\)</span>, <span class="math inline">\(\hat \beta_2\)</span>의 방향을 의미한다.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="steepdescent.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(lmdf11)</span></code></pre></div>
<pre><code>## (Intercept)          x1          x2 
##   75.085714    1.650000    0.600000</code></pre>
<p>식 <a href="steepdescent.html#eq:steepacenddata">(2.4)</a>에 나타난 최대경사 벡터 <span class="math inline">\(\nabla f\)</span>을 등고선 그림에 나타내면 다음과 같다. 아래의 등고선에서
최대경사 방향은 기울기가 <span class="math inline">\(0.6/1.65=0.364\)</span> 를 가진 원점을 지나는 직선 방향이다.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="steepdescent.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contour.lm</span>(lmdf11, x2<span class="sc">~</span>x1, <span class="at">xlabs=</span><span class="fu">c</span>( <span class="st">&quot;x1&quot;</span>, <span class="st">&quot;x2&quot;</span>), <span class="at">bounds =</span> <span class="fu">list</span>(<span class="at">x1 =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>), <span class="at">x2 =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>)))</span>
<span id="cb15-2"><a href="steepdescent.html#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>, <span class="dv">0</span>), <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">cex=</span><span class="fl">1.3</span>, <span class="at">pch=</span><span class="dv">19</span>)</span>
<span id="cb15-3"><a href="steepdescent.html#cb15-3" aria-hidden="true" tabindex="-1"></a>slope <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>( <span class="fu">coef</span>(lmdf11)[<span class="st">&quot;x2&quot;</span>] <span class="sc">/</span> <span class="fu">coef</span>(lmdf11)[<span class="st">&quot;x1&quot;</span>])</span>
<span id="cb15-4"><a href="steepdescent.html#cb15-4" aria-hidden="true" tabindex="-1"></a>slope</span></code></pre></div>
<pre><code>## [1] 0.36363636</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="steepdescent.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">y=</span><span class="fu">c</span>(<span class="dv">0</span>,slope ), <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb17-2"><a href="steepdescent.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb17-3"><a href="steepdescent.html#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:plot6"></span>
<img src="responsesurface_files/figure-html/plot6-1.png" alt="일차 선형식(빨간선이 최대경사 방향)" width="70%" />
<p class="caption">
그림 2.5: 일차 선형식(빨간선이 최대경사 방향)
</p>
</div>
<p>최대경사 벡터를 구하는 경우 벡터의 길이가 1 이 되도록 하는 경우도 있다. 이러한 경우의 최대경사 방향의 벡터는 다음과 같다.</p>
<p><span class="math display" id="eq:steepacenddata2">\[\begin{equation}
\begin{bmatrix} 
1.65 / \sqrt{1.65^2 + 0.06^2}  \\
0.60 / \sqrt{1.65^2 + 0.06^2}  \\
\end{bmatrix} 
=
\begin{bmatrix} 
0.9398 \\
0.3417
\end{bmatrix} 
\tag{2.5}
\end{equation}\]</span></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="steepdescent.html#cb18-1" aria-hidden="true" tabindex="-1"></a>radi <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(<span class="fu">c</span>(<span class="fu">coef</span>(lmdf11)[<span class="st">&quot;x1&quot;</span>], <span class="fu">coef</span>(lmdf11)[<span class="st">&quot;x2&quot;</span>])<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb18-2"><a href="steepdescent.html#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">coef</span>(lmdf11)[<span class="st">&quot;x1&quot;</span>], <span class="fu">coef</span>(lmdf11)[<span class="st">&quot;x2&quot;</span>])<span class="sc">/</span>radi</span></code></pre></div>
<pre><code>##         x1         x2 
## 0.93979342 0.34174306</code></pre>
</div>
<div id="패키지-rsm" class="section level2" number="2.5">
<h2><span class="header-section-number">2.5</span> 패키지 <code>rsm</code></h2>
<p>위에서 언급한 분석을 포함한 다양한 반응표면 분석은 패키지 <code>rsm</code> 에 있는 여러 가지 함수를 이용하여 쉽게 수행할 수 있다.</p>
<div id="일차-선형식의-적합" class="section level3" number="2.5.1">
<h3><span class="header-section-number">2.5.1</span> 일차 선형식의 적합</h3>
<p>먼저 일차 선형식 <a href="steepdescent.html#eq:linearmodel">(2.1)</a> 을 적합하는 경우 함수 <code>rsm()</code> 을 다음과 같이 사용할 수 있다.
모형식에서 <code>FO(x1, x2)</code> 는 2개의 변수 <code>x1</code> 과 <code>x2</code> 로 구성된 일차선형식(<code>FO</code>; First Order function)를 사용하는 것을 의미한다.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="steepdescent.html#cb20-1" aria-hidden="true" tabindex="-1"></a>rsmdf1 <span class="ot">&lt;-</span> <span class="fu">rsm</span>(y <span class="sc">~</span> <span class="fu">FO</span>(x1, x2), <span class="at">data =</span> df11)</span>
<span id="cb20-2"><a href="steepdescent.html#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rsmdf1)</span></code></pre></div>
<pre><code>## 
## Call:
## rsm(formula = y ~ FO(x1, x2), data = df11)
## 
##              Estimate Std. Error   t value   Pr(&gt;|t|)    
## (Intercept) 75.085714   0.151017 497.20054 9.8178e-11 ***
## x1           1.650000   0.199777   8.25922  0.0011725 ** 
## x2           0.600000   0.199777   3.00335  0.0398101 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Multiple R-squared:  0.95076,    Adjusted R-squared:  0.92614 
## F-statistic: 38.617 on 2 and 4 DF,  p-value: 0.0024246
## 
## Analysis of Variance Table
## 
## Response: y
##             Df   Sum Sq Mean Sq  F value    Pr(&gt;F)
## FO(x1, x2)   2 12.33000 6.16500 38.61745 0.0024246
## Residuals    4  0.63857 0.15964                   
## Lack of fit  2  0.31857 0.15929  0.99554 0.5011186
## Pure error   2  0.32000 0.16000                   
## 
## Direction of steepest ascent (at radius 1):
##         x1         x2 
## 0.93979342 0.34174306 
## 
## Corresponding increment in original units:
##      time      temp 
## 4.6989671 3.4174306</code></pre>
<p>위의 함수 <code>rsm()</code>에서 얻은 결과는 선형모형을 적합하는 함수 <code>lm()</code> 의 결과에 추가적은 분석 결과가 포함된다. 추가 분석에 대한 설명은 다음과 같다.</p>
<ul>
<li><p>Analysis of Variance Table 는 일반적인 분산분석표에 2차 반응표면 함수의 각 부분에 대한 유의성 F-검정이 주어진다. 반복이 있는 경우 적합성결여 검정(lack of fit test)이 주어지며 해당하는 p-값이 유의수준 <span class="math inline">\(\alpha\)</span> 보다 작으면 모형의 적합성에 문제가 있다는 의미이다. 위의 결과에서는 분산분석에서 <code>Lack of fit</code> 에 대한 p-값이 0.5011 이므로 선형모형의 적합성에는 큰 문제가 없다.</p></li>
<li><p>Direction of steepest ascent (at radius 1) 부분에서는 길이가 1 인 최대경사 벡터 <span class="math inline">\(\nabla f\)</span>를 구해준다.</p></li>
<li><p>Corresponding increment in original units 부분에서는 최대경사 벡터를 원래 변환되기 전의 자료의 단위로 구해준다.</p></li>
</ul>
</div>
<div id="등고선-그림" class="section level3" number="2.5.2">
<h3><span class="header-section-number">2.5.2</span> 등고선 그림</h3>
<p>반응 표면의 등고선 그림은 함수 <code>rsm()</code> 의 적합 결과를 이용하여 <code>contour()</code> 함수를 사용하면 쉽게 그릴 수 있다.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="steepdescent.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contour</span>(rsmdf1, <span class="sc">~</span> x1 <span class="sc">+</span> x2)</span>
<span id="cb22-2"><a href="steepdescent.html#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contour</span>(rsmdf1, <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">image =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:plot7"></span>
<img src="responsesurface_files/figure-html/plot7-1.png" alt="rsm 결과를 이용한 등고선 그림 " width="50%" /><img src="responsesurface_files/figure-html/plot7-2.png" alt="rsm 결과를 이용한 등고선 그림 " width="50%" />
<p class="caption">
그림 2.6: rsm 결과를 이용한 등고선 그림
</p>
</div>
</div>
<div id="최적-실험점-탐색" class="section level3" number="2.5.3">
<h3><span class="header-section-number">2.5.3</span> 최적 실험점 탐색</h3>
<p>이제 실험 원점 <span class="math inline">\((0,0)\)</span> 에서 최대경사 벡터 <span class="math inline">\(\nabla f\)</span> 방향으로 여러 개의 실험점을 계산하려면 함수 <code>steepest()</code>를 사용한다.
아래의 함수에서 <code>dist=seq(0,5, by=1)</code> 는 최대경사 벡터 방향으로 길이가 1 만큼 증가하면서 길이가 5인 점까지 실험점을 구하라는 의미이다.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="steepdescent.html#cb23-1" aria-hidden="true" tabindex="-1"></a>deltapoints <span class="ot">&lt;-</span> <span class="fu">steepest</span>(rsmdf1, <span class="at">dist=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">5</span>, <span class="at">by=</span><span class="dv">1</span>))</span></code></pre></div>
<pre><code>## Path of steepest ascent from ridge analysis:</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="steepdescent.html#cb25-1" aria-hidden="true" tabindex="-1"></a>deltapoints</span></code></pre></div>
<pre><code>##   dist    x1    x2 |   time   temp |   yhat
## 1    0 0.000 0.000 | 35.000 170.00 | 75.086
## 2    1 0.940 0.342 | 39.700 173.42 | 76.842
## 3    2 1.880 0.683 | 44.400 176.83 | 78.598
## 4    3 2.819 1.025 | 49.095 180.25 | 80.352
## 5    4 3.759 1.367 | 53.795 183.67 | 82.108
## 6    5 4.699 1.709 | 58.495 187.09 | 83.864</code></pre>
<p>위에서 구한 실험점들을 등고선 그림에 표시하면 다음과 같다.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="steepdescent.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contour</span>(rsmdf1, <span class="sc">~</span> x1 <span class="sc">+</span> x2,  <span class="at">bounds =</span> <span class="fu">list</span>(<span class="at">x1 =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>), <span class="at">x2 =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>)))</span>
<span id="cb27-2"><a href="steepdescent.html#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(deltapoints<span class="sc">$</span>time, deltapoints<span class="sc">$</span>temp, <span class="at">cex=</span><span class="fl">1.2</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">pch=</span><span class="dv">19</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:plot8"></span>
<img src="responsesurface_files/figure-html/plot8-1.png" alt="최대경사 벡터 방향의 실험점" width="50%" />
<p class="caption">
그림 2.7: 최대경사 벡터 방향의 실험점
</p>
</div>
<p>만약 아래 그림과 같이 최대경사 방향으로 4번의 실험을 수행하였다면 다음 실험의 중심점은 <span class="math inline">\((50, 180.9)\)</span>를 선택한다. 왜냐하면 더 경사면으로 올라간 실험점 <span class="math inline">\((55, 184.6)\)</span> 에서는 반응값이 감소하기 때문이다.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-13"></span>
<img src="myimages/response-05.png" alt="최대경사법을 이용한 실험점 찾기" width="70%" />
<p class="caption">
그림 2.8: 최대경사법을 이용한 실험점 찾기
</p>
</div>
</div>
</div>
<div id="변량이-3개-이상인-경우" class="section level2" number="2.6">
<h2><span class="header-section-number">2.6</span> 변량이 3개 이상인 경우</h2>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="steepdescent.html#cb28-1" aria-hidden="true" tabindex="-1"></a>heli</span></code></pre></div>
<pre><code>##    block    A    R    W   L ave logSD
## 1      1 11.8 2.26 1.00 1.5 367    72
## 2      1 13.0 2.26 1.00 1.5 369    72
## 3      1 11.8 2.78 1.00 1.5 374    74
## 4      1 13.0 2.78 1.00 1.5 370    79
## 5      1 11.8 2.26 1.50 1.5 372    72
## 6      1 13.0 2.26 1.50 1.5 355    81
## 7      1 11.8 2.78 1.50 1.5 397    72
## 8      1 13.0 2.78 1.50 1.5 377    99
## 9      1 11.8 2.26 1.00 2.5 350    90
## 10     1 13.0 2.26 1.00 2.5 373    86
## 11     1 11.8 2.78 1.00 2.5 358    92
## 12     1 13.0 2.78 1.00 2.5 363   112
## 13     1 11.8 2.26 1.50 2.5 344    76
## 14     1 13.0 2.26 1.50 2.5 355    69
## 15     1 11.8 2.78 1.50 2.5 370    91
## 16     1 13.0 2.78 1.50 2.5 362    71
## 17     1 12.4 2.52 1.25 2.0 377    51
## 18     1 12.4 2.52 1.25 2.0 375    74
## 19     2 11.2 2.52 1.25 2.0 361   111
## 20     2 13.6 2.52 1.25 2.0 364    93
## 21     2 12.4 2.00 1.25 2.0 355   100
## 22     2 12.4 3.04 1.25 2.0 373    80
## 23     2 12.4 2.52 0.75 2.0 361    71
## 24     2 12.4 2.52 1.75 2.0 360    98
## 25     2 12.4 2.52 1.25 1.0 380    69
## 26     2 12.4 2.52 1.25 3.0 360    74
## 27     2 12.4 2.52 1.25 2.0 370    86
## 28     2 12.4 2.52 1.25 2.0 368    74
## 29     2 12.4 2.52 1.25 2.0 369    89
## 30     2 12.4 2.52 1.25 2.0 366    76
## 
## Data are stored in coded form using these coding formulas ...
## x1 ~ (A - 12.4)/0.6
## x2 ~ (R - 2.52)/0.26
## x3 ~ (W - 1.25)/0.25
## x4 ~ (L - 2)/0.5</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="steepdescent.html#cb30-1" aria-hidden="true" tabindex="-1"></a>heli.rsm <span class="ot">&lt;-</span> <span class="fu">rsm</span>(ave <span class="sc">~</span>  <span class="fu">FO</span>(x1, x2, x3, x4), <span class="at">data =</span> heli)</span>
<span id="cb30-2"><a href="steepdescent.html#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(heli.rsm)</span></code></pre></div>
<pre><code>## 
## Call:
## rsm(formula = ave ~ FO(x1, x2, x3, x4), data = heli)
## 
##                Estimate  Std. Error   t value   Pr(&gt;|t|)    
## (Intercept) 366.5000000   1.4373587 254.98159 &lt; 2.22e-16 ***
## x1           -0.0833333   1.6070159  -0.05186 0.95905560    
## x2            5.0833333   1.6070159   3.16321 0.00406592 ** 
## x3            0.2500000   1.6070159   0.15557 0.87762298    
## x4           -6.0833333   1.6070159  -3.78548 0.00085771 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Multiple R-squared:  0.49354,    Adjusted R-squared:  0.41251 
## F-statistic: 6.0907 on 4 and 25 DF,  p-value: 0.0014529
## 
## Analysis of Variance Table
## 
## Response: ave
##                    Df   Sum Sq Mean Sq F value    Pr(&gt;F)
## FO(x1, x2, x3, x4)  4 1510.000 377.500 6.09067 0.0014529
## Residuals          25 1549.500  61.980                  
## Lack of fit        20 1458.667  72.933 4.01468 0.0646456
## Pure error          5   90.833  18.167                  
## 
## Direction of steepest ascent (at radius 1):
##           x1           x2           x3           x4 
## -0.010505964  0.640863793  0.031517891 -0.766935359 
## 
## Corresponding increment in original units:
##             A             R             W             L 
## -0.0063035783  0.1666245863  0.0078794729 -0.3834676797</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="steepdescent.html#cb32-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb32-2"><a href="steepdescent.html#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contour</span>(heli.rsm, <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3 <span class="sc">+</span> x4)</span></code></pre></div>
<p><img src="responsesurface_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="steepdescent.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">steepest</span>(heli.rsm)</span></code></pre></div>
<pre><code>## Path of steepest ascent from ridge analysis:</code></pre>
<pre><code>##    dist     x1    x2    x3     x4 |       A       R       W      L |    yhat
## 1   0.0  0.000 0.000 0.000  0.000 | 12.4000 2.52000 1.25000 2.0000 | 366.500
## 2   0.5 -0.005 0.320 0.016 -0.383 | 12.3970 2.60320 1.25400 1.8085 | 370.461
## 3   1.0 -0.011 0.641 0.032 -0.767 | 12.3934 2.68666 1.25800 1.6165 | 374.433
## 4   1.5 -0.016 0.961 0.047 -1.150 | 12.3904 2.76986 1.26175 1.4250 | 378.394
## 5   2.0 -0.021 1.282 0.063 -1.534 | 12.3874 2.85332 1.26575 1.2330 | 382.366
## 6   2.5 -0.026 1.602 0.079 -1.917 | 12.3844 2.93652 1.26975 1.0415 | 386.327
## 7   3.0 -0.032 1.923 0.095 -2.301 | 12.3808 3.01998 1.27375 0.8495 | 390.299
## 8   3.5 -0.037 2.243 0.110 -2.684 | 12.3778 3.10318 1.27750 0.6580 | 394.260
## 9   4.0 -0.042 2.563 0.126 -3.068 | 12.3748 3.18638 1.28150 0.4660 | 398.227
## 10  4.5 -0.047 2.884 0.142 -3.451 | 12.3718 3.26984 1.28550 0.2745 | 402.193
## 11  5.0 -0.053 3.204 0.158 -3.835 | 12.3682 3.35304 1.28950 0.0825 | 406.160</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="responseintro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="secondorder.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["responsesurface.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
